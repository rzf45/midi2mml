var ke=Object.defineProperty;var Ie=(t,e,r)=>e in t?ke(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var ce=(t,e,r)=>(Ie(t,typeof e!="symbol"?e+"":e,r),r);const xe=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const n of s.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&i(n)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerpolicy&&(s.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?s.credentials="include":a.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}};xe();var M=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Te(t){var e=t.default;if(typeof e=="function"){var r=function(){return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var a=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(r,i,a.get?a:{enumerable:!0,get:function(){return t[i]}})}),r}var de={},V={};function Se(t){var e=new x(t),r=e.readChunk();if(r.id!="MThd")throw"Bad MIDI file.  Expected 'MHdr', got: '"+r.id+"'";for(var i=we(r.data),a=[],s=0;!e.eof()&&s<i.numTracks;s++){var n=e.readChunk();if(n.id!="MTrk")throw"Bad MIDI file.  Expected 'MTrk', got: '"+n.id+"'";var l=Oe(n.data);a.push(l)}return{header:i,tracks:a}}function we(t){var e=new x(t),r=e.readUInt16(),i=e.readUInt16(),a={format:r,numTracks:i},s=e.readUInt16();return s&32768?(a.framesPerSecond=256-(s>>8),a.ticksPerFrame=s&255):a.ticksPerBeat=s,a}function Oe(t){for(var e=new x(t),r=[];!e.eof();){var i=s();r.push(i)}return r;var a;function s(){var n={};n.deltaTime=e.readVarInt();var l=e.readUInt8();if((l&240)===240)if(l===255){n.meta=!0;var o=e.readUInt8(),c=e.readVarInt();switch(o){case 0:if(n.type="sequenceNumber",c!==2)throw"Expected length for sequenceNumber event is 2, got "+c;return n.number=e.readUInt16(),n;case 1:return n.type="text",n.text=e.readString(c),n;case 2:return n.type="copyrightNotice",n.text=e.readString(c),n;case 3:return n.type="trackName",n.text=e.readString(c),n;case 4:return n.type="instrumentName",n.text=e.readString(c),n;case 5:return n.type="lyrics",n.text=e.readString(c),n;case 6:return n.type="marker",n.text=e.readString(c),n;case 7:return n.type="cuePoint",n.text=e.readString(c),n;case 32:if(n.type="channelPrefix",c!=1)throw"Expected length for channelPrefix event is 1, got "+c;return n.channel=e.readUInt8(),n;case 33:if(n.type="portPrefix",c!=1)throw"Expected length for portPrefix event is 1, got "+c;return n.port=e.readUInt8(),n;case 47:if(n.type="endOfTrack",c!=0)throw"Expected length for endOfTrack event is 0, got "+c;return n;case 81:if(n.type="setTempo",c!=3)throw"Expected length for setTempo event is 3, got "+c;return n.microsecondsPerBeat=e.readUInt24(),n;case 84:if(n.type="smpteOffset",c!=5)throw"Expected length for smpteOffset event is 5, got "+c;var d=e.readUInt8(),f={0:24,32:25,64:29,96:30};return n.frameRate=f[d&96],n.hour=d&31,n.min=e.readUInt8(),n.sec=e.readUInt8(),n.frame=e.readUInt8(),n.subFrame=e.readUInt8(),n;case 88:if(n.type="timeSignature",c!=2&&c!=4)throw"Expected length for timeSignature event is 4 or 2, got "+c;return n.numerator=e.readUInt8(),n.denominator=1<<e.readUInt8(),c===4?(n.metronome=e.readUInt8(),n.thirtyseconds=e.readUInt8()):(n.metronome=36,n.thirtyseconds=8),n;case 89:if(n.type="keySignature",c!=2)throw"Expected length for keySignature event is 2, got "+c;return n.key=e.readInt8(),n.scale=e.readUInt8(),n;case 127:return n.type="sequencerSpecific",n.data=e.readBytes(c),n;default:return n.type="unknownMeta",n.data=e.readBytes(c),n.metatypeByte=o,n}}else if(l==240){n.type="sysEx";var c=e.readVarInt();return n.data=e.readBytes(c),n}else if(l==247){n.type="endSysEx";var c=e.readVarInt();return n.data=e.readBytes(c),n}else throw"Unrecognised MIDI event type byte: "+l;else{var u;if((l&128)===0){if(a===null)throw"Running status byte encountered before status byte";u=l,l=a,n.running=!0}else u=e.readUInt8(),a=l;var h=l>>4;switch(n.channel=l&15,h){case 8:return n.type="noteOff",n.noteNumber=u,n.velocity=e.readUInt8(),n;case 9:var y=e.readUInt8();return n.type=y===0?"noteOff":"noteOn",n.noteNumber=u,n.velocity=y,y===0&&(n.byte9=!0),n;case 10:return n.type="noteAftertouch",n.noteNumber=u,n.amount=e.readUInt8(),n;case 11:return n.type="controller",n.controllerType=u,n.value=e.readUInt8(),n;case 12:return n.type="programChange",n.programNumber=u,n;case 13:return n.type="channelAftertouch",n.amount=u,n;case 14:return n.type="pitchBend",n.value=u+(e.readUInt8()<<7)-8192,n;default:throw"Unrecognised MIDI event type: "+h}}}}function x(t){this.buffer=t,this.bufferLen=this.buffer.length,this.pos=0}x.prototype.eof=function(){return this.pos>=this.bufferLen};x.prototype.readUInt8=function(){var t=this.buffer[this.pos];return this.pos+=1,t};x.prototype.readInt8=function(){var t=this.readUInt8();return t&128?t-256:t};x.prototype.readUInt16=function(){var t=this.readUInt8(),e=this.readUInt8();return(t<<8)+e};x.prototype.readInt16=function(){var t=this.readUInt16();return t&32768?t-65536:t};x.prototype.readUInt24=function(){var t=this.readUInt8(),e=this.readUInt8(),r=this.readUInt8();return(t<<16)+(e<<8)+r};x.prototype.readInt24=function(){var t=this.readUInt24();return t&8388608?t-16777216:t};x.prototype.readUInt32=function(){var t=this.readUInt8(),e=this.readUInt8(),r=this.readUInt8(),i=this.readUInt8();return(t<<24)+(e<<16)+(r<<8)+i};x.prototype.readBytes=function(t){var e=this.buffer.slice(this.pos,this.pos+t);return this.pos+=t,e};x.prototype.readString=function(t){var e=this.readBytes(t);return String.fromCharCode.apply(null,e)};x.prototype.readVarInt=function(){for(var t=0;!this.eof();){var e=this.readUInt8();if(e&128)t+=e&127,t<<=7;else return t+e}return t};x.prototype.readChunk=function(){var t=this.readString(4),e=this.readUInt32(),r=this.readBytes(e);return{id:t,length:e,data:r}};var Ue=Se;function Ce(t,e){if(typeof t!="object")throw"Invalid MIDI data";e=e||{};var r=t.header||{},i=t.tracks||[],a,s=i.length,n=new v;for(Ne(n,r,s),a=0;a<s;a++)Me(n,i[a],e);return n.buffer}function Ne(t,e,r){var i=e.format==null?1:e.format,a=128;e.timeDivision?a=e.timeDivision:e.ticksPerFrame&&e.framesPerSecond?a=-(e.framesPerSecond&255)<<8|e.ticksPerFrame&255:e.ticksPerBeat&&(a=e.ticksPerBeat&32767);var s=new v;s.writeUInt16(i),s.writeUInt16(r),s.writeUInt16(a),t.writeChunk("MThd",s.buffer)}function Me(t,e,r){var i=new v,a,s=e.length,n=null;for(a=0;a<s;a++)(r.running===!1||!r.running&&!e[a].running)&&(n=null),n=Fe(i,e[a],n,r.useByte9ForNoteOff);t.writeChunk("MTrk",i.buffer)}function Fe(t,e,r,i){var a=e.type,s=e.deltaTime,n=e.text||"",l=e.data||[],o=null;switch(t.writeVarInt(s),a){case"sequenceNumber":t.writeUInt8(255),t.writeUInt8(0),t.writeVarInt(2),t.writeUInt16(e.number);break;case"text":t.writeUInt8(255),t.writeUInt8(1),t.writeVarInt(n.length),t.writeString(n);break;case"copyrightNotice":t.writeUInt8(255),t.writeUInt8(2),t.writeVarInt(n.length),t.writeString(n);break;case"trackName":t.writeUInt8(255),t.writeUInt8(3),t.writeVarInt(n.length),t.writeString(n);break;case"instrumentName":t.writeUInt8(255),t.writeUInt8(4),t.writeVarInt(n.length),t.writeString(n);break;case"lyrics":t.writeUInt8(255),t.writeUInt8(5),t.writeVarInt(n.length),t.writeString(n);break;case"marker":t.writeUInt8(255),t.writeUInt8(6),t.writeVarInt(n.length),t.writeString(n);break;case"cuePoint":t.writeUInt8(255),t.writeUInt8(7),t.writeVarInt(n.length),t.writeString(n);break;case"channelPrefix":t.writeUInt8(255),t.writeUInt8(32),t.writeVarInt(1),t.writeUInt8(e.channel);break;case"portPrefix":t.writeUInt8(255),t.writeUInt8(33),t.writeVarInt(1),t.writeUInt8(e.port);break;case"endOfTrack":t.writeUInt8(255),t.writeUInt8(47),t.writeVarInt(0);break;case"setTempo":t.writeUInt8(255),t.writeUInt8(81),t.writeVarInt(3),t.writeUInt24(e.microsecondsPerBeat);break;case"smpteOffset":t.writeUInt8(255),t.writeUInt8(84),t.writeVarInt(5);var c={24:0,25:32,29:64,30:96},d=e.hour&31|c[e.frameRate];t.writeUInt8(d),t.writeUInt8(e.min),t.writeUInt8(e.sec),t.writeUInt8(e.frame),t.writeUInt8(e.subFrame);break;case"timeSignature":t.writeUInt8(255),t.writeUInt8(88),t.writeVarInt(4),t.writeUInt8(e.numerator);var f=Math.floor(Math.log(e.denominator)/Math.LN2)&255;t.writeUInt8(f),t.writeUInt8(e.metronome),t.writeUInt8(e.thirtyseconds||8);break;case"keySignature":t.writeUInt8(255),t.writeUInt8(89),t.writeVarInt(2),t.writeInt8(e.key),t.writeUInt8(e.scale);break;case"sequencerSpecific":t.writeUInt8(255),t.writeUInt8(127),t.writeVarInt(l.length),t.writeBytes(l);break;case"unknownMeta":e.metatypeByte!=null&&(t.writeUInt8(255),t.writeUInt8(e.metatypeByte),t.writeVarInt(l.length),t.writeBytes(l));break;case"sysEx":t.writeUInt8(240),t.writeVarInt(l.length),t.writeBytes(l);break;case"endSysEx":t.writeUInt8(247),t.writeVarInt(l.length),t.writeBytes(l);break;case"noteOff":var u=i!==!1&&e.byte9||i&&e.velocity==0?144:128;o=u|e.channel,o!==r&&t.writeUInt8(o),t.writeUInt8(e.noteNumber),t.writeUInt8(e.velocity);break;case"noteOn":o=144|e.channel,o!==r&&t.writeUInt8(o),t.writeUInt8(e.noteNumber),t.writeUInt8(e.velocity);break;case"noteAftertouch":o=160|e.channel,o!==r&&t.writeUInt8(o),t.writeUInt8(e.noteNumber),t.writeUInt8(e.amount);break;case"controller":o=176|e.channel,o!==r&&t.writeUInt8(o),t.writeUInt8(e.controllerType),t.writeUInt8(e.value);break;case"programChange":o=192|e.channel,o!==r&&t.writeUInt8(o),t.writeUInt8(e.programNumber);break;case"channelAftertouch":o=208|e.channel,o!==r&&t.writeUInt8(o),t.writeUInt8(e.amount);break;case"pitchBend":o=224|e.channel,o!==r&&t.writeUInt8(o);var h=8192+e.value,y=h&127,b=h>>7&127;t.writeUInt8(y),t.writeUInt8(b);break;default:throw"Unrecognized event type: "+a}return o}function v(){this.buffer=[]}v.prototype.writeUInt8=function(t){this.buffer.push(t&255)};v.prototype.writeInt8=v.prototype.writeUInt8;v.prototype.writeUInt16=function(t){var e=t>>8&255,r=t&255;this.writeUInt8(e),this.writeUInt8(r)};v.prototype.writeInt16=v.prototype.writeUInt16;v.prototype.writeUInt24=function(t){var e=t>>16&255,r=t>>8&255,i=t&255;this.writeUInt8(e),this.writeUInt8(r),this.writeUInt8(i)};v.prototype.writeInt24=v.prototype.writeUInt24;v.prototype.writeUInt32=function(t){var e=t>>24&255,r=t>>16&255,i=t>>8&255,a=t&255;this.writeUInt8(e),this.writeUInt8(r),this.writeUInt8(i),this.writeUInt8(a)};v.prototype.writeInt32=v.prototype.writeUInt32;v.prototype.writeBytes=function(t){this.buffer=this.buffer.concat(Array.prototype.slice.call(t,0))};v.prototype.writeString=function(t){var e,r=t.length,i=[];for(e=0;e<r;e++)i.push(t.codePointAt(e));this.writeBytes(i)};v.prototype.writeVarInt=function(t){if(t<0)throw"Cannot write negative variable-length integer";if(t<=127)this.writeUInt8(t);else{var e=t,r=[];for(r.push(e&127),e>>=7;e;){var i=e&127|128;r.push(i),e>>=7}this.writeBytes(r.reverse())}};v.prototype.writeChunk=function(t,e){this.writeString(t),this.writeUInt32(e.length),this.writeBytes(e)};var Pe=Ce;V.parseMidi=Ue;V.writeMidi=Pe;var J={},C={};Object.defineProperty(C,"__esModule",{value:!0});C.insert=C.search=void 0;function me(t,e,r){r===void 0&&(r="ticks");var i=0,a=t.length,s=a;if(a>0&&t[a-1][r]<=e)return a-1;for(;i<s;){var n=Math.floor(i+(s-i)/2),l=t[n],o=t[n+1];if(l[r]===e){for(var c=n;c<t.length;c++){var d=t[c];d[r]===e&&(n=c)}return n}else{if(l[r]<e&&o[r]>e)return n;l[r]>e?s=n:l[r]<e&&(i=n+1)}}return-1}C.search=me;function Be(t,e,r){if(r===void 0&&(r="ticks"),t.length){var i=me(t,e[r],r);t.splice(i+1,0,e)}else t.push(e)}C.insert=Be;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Header=t.keySignatureKeys=void 0;var e=C,r=new WeakMap;t.keySignatureKeys=["Cb","Gb","Db","Ab","Eb","Bb","F","C","G","D","A","E","B","F#","C#"];var i=function(){function a(s){var n=this;if(this.tempos=[],this.timeSignatures=[],this.keySignatures=[],this.meta=[],this.name="",r.set(this,480),s){r.set(this,s.header.ticksPerBeat),s.tracks.forEach(function(o){o.forEach(function(c){c.meta&&(c.type==="timeSignature"?n.timeSignatures.push({ticks:c.absoluteTime,timeSignature:[c.numerator,c.denominator]}):c.type==="setTempo"?n.tempos.push({bpm:6e7/c.microsecondsPerBeat,ticks:c.absoluteTime}):c.type==="keySignature"&&n.keySignatures.push({key:t.keySignatureKeys[c.key+7],scale:c.scale===0?"major":"minor",ticks:c.absoluteTime}))})});var l=0;s.tracks[0].forEach(function(o){l+=o.deltaTime,o.meta&&(o.type==="trackName"?n.name=o.text:(o.type==="text"||o.type==="cuePoint"||o.type==="marker"||o.type==="lyrics")&&n.meta.push({text:o.text,ticks:l,type:o.type}))}),this.update()}}return a.prototype.update=function(){var s=this,n=0,l=0;this.tempos.sort(function(o,c){return o.ticks-c.ticks}),this.tempos.forEach(function(o,c){var d=c>0?s.tempos[c-1].bpm:s.tempos[0].bpm,f=o.ticks/s.ppq-l,u=60/d*f;o.time=u+n,n=o.time,l+=f}),this.timeSignatures.sort(function(o,c){return o.ticks-c.ticks}),this.timeSignatures.forEach(function(o,c){var d=c>0?s.timeSignatures[c-1]:s.timeSignatures[0],f=(o.ticks-d.ticks)/s.ppq,u=f/d.timeSignature[0]/(d.timeSignature[1]/4);d.measures=d.measures||0,o.measures=u+d.measures})},a.prototype.ticksToSeconds=function(s){var n=(0,e.search)(this.tempos,s);if(n!==-1){var l=this.tempos[n],o=l.time,c=(s-l.ticks)/this.ppq;return o+60/l.bpm*c}else{var d=s/this.ppq;return 60/120*d}},a.prototype.ticksToMeasures=function(s){var n=(0,e.search)(this.timeSignatures,s);if(n!==-1){var l=this.timeSignatures[n],o=(s-l.ticks)/this.ppq;return l.measures+o/(l.timeSignature[0]/l.timeSignature[1])/4}else return s/this.ppq/4},Object.defineProperty(a.prototype,"ppq",{get:function(){return r.get(this)},enumerable:!1,configurable:!0}),a.prototype.secondsToTicks=function(s){var n=(0,e.search)(this.tempos,s,"time");if(n!==-1){var l=this.tempos[n],o=l.time,c=s-o,d=c/(60/l.bpm);return Math.round(l.ticks+d*this.ppq)}else{var f=s/.5;return Math.round(f*this.ppq)}},a.prototype.toJSON=function(){return{keySignatures:this.keySignatures,meta:this.meta,name:this.name,ppq:this.ppq,tempos:this.tempos.map(function(s){return{bpm:s.bpm,ticks:s.ticks}}),timeSignatures:this.timeSignatures}},a.prototype.fromJSON=function(s){this.name=s.name,this.tempos=s.tempos.map(function(n){return Object.assign({},n)}),this.timeSignatures=s.timeSignatures.map(function(n){return Object.assign({},n)}),this.keySignatures=s.keySignatures.map(function(n){return Object.assign({},n)}),this.meta=s.meta.map(function(n){return Object.assign({},n)}),r.set(this,s.ppq),this.update()},a.prototype.setTempo=function(s){this.tempos=[{bpm:s,ticks:0}],this.update()},a}();t.Header=i})(J);var E={},ee={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ControlChange=t.controlChangeIds=t.controlChangeNames=void 0,t.controlChangeNames={1:"modulationWheel",2:"breath",4:"footController",5:"portamentoTime",7:"volume",8:"balance",10:"pan",64:"sustain",65:"portamentoTime",66:"sostenuto",67:"softPedal",68:"legatoFootswitch",84:"portamentoControl"},t.controlChangeIds=Object.keys(t.controlChangeNames).reduce(function(a,s){return a[t.controlChangeNames[s]]=s,a},{});var e=new WeakMap,r=new WeakMap,i=function(){function a(s,n){e.set(this,n),r.set(this,s.controllerType),this.ticks=s.absoluteTime,this.value=s.value}return Object.defineProperty(a.prototype,"number",{get:function(){return r.get(this)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"name",{get:function(){return t.controlChangeNames[this.number]?t.controlChangeNames[this.number]:null},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"time",{get:function(){var s=e.get(this);return s.ticksToSeconds(this.ticks)},set:function(s){var n=e.get(this);this.ticks=n.secondsToTicks(s)},enumerable:!1,configurable:!0}),a.prototype.toJSON=function(){return{number:this.number,ticks:this.ticks,time:this.time,value:this.value}},a}();t.ControlChange=i})(ee);var L={};Object.defineProperty(L,"__esModule",{value:!0});L.createControlChanges=void 0;var j=ee;function _e(){return new Proxy({},{get:function(t,e){if(t[e])return t[e];if(j.controlChangeIds.hasOwnProperty(e))return t[j.controlChangeIds[e]]},set:function(t,e,r){return j.controlChangeIds.hasOwnProperty(e)?t[j.controlChangeIds[e]]=r:t[e]=r,!0}})}L.createControlChanges=_e;var $={};Object.defineProperty($,"__esModule",{value:!0});$.PitchBend=void 0;var K=new WeakMap,Ee=function(){function t(e,r){K.set(this,r),this.ticks=e.absoluteTime,this.value=e.value}return Object.defineProperty(t.prototype,"time",{get:function(){var e=K.get(this);return e.ticksToSeconds(this.ticks)},set:function(e){var r=K.get(this);this.ticks=r.secondsToTicks(e)},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return{ticks:this.ticks,time:this.time,value:this.value}},t}();$.PitchBend=Ee;var H={},O={};Object.defineProperty(O,"__esModule",{value:!0});O.DrumKitByPatchID=O.InstrumentFamilyByID=O.instrumentByPatchID=void 0;O.instrumentByPatchID=["acoustic grand piano","bright acoustic piano","electric grand piano","honky-tonk piano","electric piano 1","electric piano 2","harpsichord","clavi","celesta","glockenspiel","music box","vibraphone","marimba","xylophone","tubular bells","dulcimer","drawbar organ","percussive organ","rock organ","church organ","reed organ","accordion","harmonica","tango accordion","acoustic guitar (nylon)","acoustic guitar (steel)","electric guitar (jazz)","electric guitar (clean)","electric guitar (muted)","overdriven guitar","distortion guitar","guitar harmonics","acoustic bass","electric bass (finger)","electric bass (pick)","fretless bass","slap bass 1","slap bass 2","synth bass 1","synth bass 2","violin","viola","cello","contrabass","tremolo strings","pizzicato strings","orchestral harp","timpani","string ensemble 1","string ensemble 2","synthstrings 1","synthstrings 2","choir aahs","voice oohs","synth voice","orchestra hit","trumpet","trombone","tuba","muted trumpet","french horn","brass section","synthbrass 1","synthbrass 2","soprano sax","alto sax","tenor sax","baritone sax","oboe","english horn","bassoon","clarinet","piccolo","flute","recorder","pan flute","blown bottle","shakuhachi","whistle","ocarina","lead 1 (square)","lead 2 (sawtooth)","lead 3 (calliope)","lead 4 (chiff)","lead 5 (charang)","lead 6 (voice)","lead 7 (fifths)","lead 8 (bass + lead)","pad 1 (new age)","pad 2 (warm)","pad 3 (polysynth)","pad 4 (choir)","pad 5 (bowed)","pad 6 (metallic)","pad 7 (halo)","pad 8 (sweep)","fx 1 (rain)","fx 2 (soundtrack)","fx 3 (crystal)","fx 4 (atmosphere)","fx 5 (brightness)","fx 6 (goblins)","fx 7 (echoes)","fx 8 (sci-fi)","sitar","banjo","shamisen","koto","kalimba","bag pipe","fiddle","shanai","tinkle bell","agogo","steel drums","woodblock","taiko drum","melodic tom","synth drum","reverse cymbal","guitar fret noise","breath noise","seashore","bird tweet","telephone ring","helicopter","applause","gunshot"];O.InstrumentFamilyByID=["piano","chromatic percussion","organ","guitar","bass","strings","ensemble","brass","reed","pipe","synth lead","synth pad","synth effects","world","percussive","sound effects"];O.DrumKitByPatchID={0:"standard kit",8:"room kit",16:"power kit",24:"electronic kit",25:"tr-808 kit",32:"jazz kit",40:"brush kit",48:"orchestra kit",56:"sound fx kit"};Object.defineProperty(H,"__esModule",{value:!0});H.Instrument=void 0;var A=O,ue=new WeakMap,je=function(){function t(e,r){if(this.number=0,ue.set(this,r),this.number=0,e){var i=e.find(function(a){return a.type==="programChange"});i&&(this.number=i.programNumber)}}return Object.defineProperty(t.prototype,"name",{get:function(){return this.percussion?A.DrumKitByPatchID[this.number]:A.instrumentByPatchID[this.number]},set:function(e){var r=A.instrumentByPatchID.indexOf(e);r!==-1&&(this.number=r)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"family",{get:function(){return this.percussion?"drums":A.InstrumentFamilyByID[Math.floor(this.number/8)]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"percussion",{get:function(){var e=ue.get(this);return e.channel===9},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return{family:this.family,number:this.number,name:this.name}},t.prototype.fromJSON=function(e){this.number=e.number},t}();H.Instrument=je;var z={};Object.defineProperty(z,"__esModule",{value:!0});z.Note=void 0;function Ae(t){var e=Math.floor(t/12)-1;return pe(t)+e.toString()}function pe(t){var e=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],r=t%12;return e[r]}function qe(t){var e=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];return e.indexOf(t)}var Je=function(){var t=/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,e={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13};return function(r){var i=t.exec(r),a=i[1],s=i[2],n=e[a.toLowerCase()];return n+(parseInt(s,10)+1)*12}}(),N=new WeakMap,Re=function(){function t(e,r,i){N.set(this,i),this.midi=e.midi,this.velocity=e.velocity,this.noteOffVelocity=r.velocity,this.ticks=e.ticks,this.durationTicks=r.ticks-e.ticks}return Object.defineProperty(t.prototype,"name",{get:function(){return Ae(this.midi)},set:function(e){this.midi=Je(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"octave",{get:function(){return Math.floor(this.midi/12)-1},set:function(e){var r=e-this.octave;this.midi+=r*12},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pitch",{get:function(){return pe(this.midi)},set:function(e){this.midi=12*(this.octave+1)+qe(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){var e=N.get(this);return e.ticksToSeconds(this.ticks+this.durationTicks)-e.ticksToSeconds(this.ticks)},set:function(e){var r=N.get(this),i=r.secondsToTicks(this.time+e);this.durationTicks=i-this.ticks},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"time",{get:function(){var e=N.get(this);return e.ticksToSeconds(this.ticks)},set:function(e){var r=N.get(this);this.ticks=r.secondsToTicks(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bars",{get:function(){var e=N.get(this);return e.ticksToMeasures(this.ticks)},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return{duration:this.duration,durationTicks:this.durationTicks,midi:this.midi,name:this.name,ticks:this.ticks,time:this.time,velocity:this.velocity}},t}();z.Note=Re;Object.defineProperty(E,"__esModule",{value:!0});E.Track=void 0;var X=C,De=ee,Ve=L,Le=$,le=H,$e=z,q=new WeakMap,He=function(){function t(e,r){var i=this;if(this.name="",this.notes=[],this.controlChanges=(0,Ve.createControlChanges)(),this.pitchBends=[],q.set(this,r),e){var a=e.find(function(u){return u.type==="trackName"});this.name=a?a.text:""}if(this.instrument=new le.Instrument(e,this),this.channel=0,e){for(var s=e.filter(function(u){return u.type==="noteOn"}),n=e.filter(function(u){return u.type==="noteOff"}),l=function(){var u=s.shift();o.channel=u.channel;var h=n.findIndex(function(b){return b.noteNumber===u.noteNumber&&b.absoluteTime>=u.absoluteTime});if(h!==-1){var y=n.splice(h,1)[0];o.addNote({durationTicks:y.absoluteTime-u.absoluteTime,midi:u.noteNumber,noteOffVelocity:y.velocity/127,ticks:u.absoluteTime,velocity:u.velocity/127})}},o=this;s.length;)l();var c=e.filter(function(u){return u.type==="controller"});c.forEach(function(u){i.addCC({number:u.controllerType,ticks:u.absoluteTime,value:u.value/127})});var d=e.filter(function(u){return u.type==="pitchBend"});d.forEach(function(u){i.addPitchBend({ticks:u.absoluteTime,value:u.value/Math.pow(2,13)})});var f=e.find(function(u){return u.type==="endOfTrack"});this.endOfTrackTicks=f!==void 0?f.absoluteTime:void 0}}return t.prototype.addNote=function(e){var r=q.get(this),i=new $e.Note({midi:0,ticks:0,velocity:1},{ticks:0,velocity:0},r);return Object.assign(i,e),(0,X.insert)(this.notes,i,"ticks"),this},t.prototype.addCC=function(e){var r=q.get(this),i=new De.ControlChange({controllerType:e.number},r);return delete e.number,Object.assign(i,e),Array.isArray(this.controlChanges[i.number])||(this.controlChanges[i.number]=[]),(0,X.insert)(this.controlChanges[i.number],i,"ticks"),this},t.prototype.addPitchBend=function(e){var r=q.get(this),i=new Le.PitchBend({},r);return Object.assign(i,e),(0,X.insert)(this.pitchBends,i,"ticks"),this},Object.defineProperty(t.prototype,"duration",{get:function(){if(!this.notes.length)return 0;for(var e=this.notes[this.notes.length-1].time+this.notes[this.notes.length-1].duration,r=0;r<this.notes.length-1;r++){var i=this.notes[r].time+this.notes[r].duration;e<i&&(e=i)}return e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"durationTicks",{get:function(){if(!this.notes.length)return 0;for(var e=this.notes[this.notes.length-1].ticks+this.notes[this.notes.length-1].durationTicks,r=0;r<this.notes.length-1;r++){var i=this.notes[r].ticks+this.notes[r].durationTicks;e<i&&(e=i)}return e},enumerable:!1,configurable:!0}),t.prototype.fromJSON=function(e){var r=this;this.name=e.name,this.channel=e.channel,this.instrument=new le.Instrument(void 0,this),this.instrument.fromJSON(e.instrument),e.endOfTrackTicks!==void 0&&(this.endOfTrackTicks=e.endOfTrackTicks);for(var i in e.controlChanges)e.controlChanges[i]&&e.controlChanges[i].forEach(function(a){r.addCC({number:a.number,ticks:a.ticks,value:a.value})});e.notes.forEach(function(a){r.addNote({durationTicks:a.durationTicks,midi:a.midi,ticks:a.ticks,velocity:a.velocity})})},t.prototype.toJSON=function(){for(var e={},r=0;r<127;r++)this.controlChanges.hasOwnProperty(r)&&(e[r]=this.controlChanges[r].map(function(a){return a.toJSON()}));var i={channel:this.channel,controlChanges:e,pitchBends:this.pitchBends.map(function(a){return a.toJSON()}),instrument:this.instrument.toJSON(),name:this.name,notes:this.notes.map(function(a){return a.toJSON()})};return this.endOfTrackTicks!==void 0&&(i.endOfTrackTicks=this.endOfTrackTicks),i},t}();E.Track=He;var W={};function ze(t){var e=[];return ye(t,e),e}function ye(t,e){for(var r=0;r<t.length;r++){var i=t[r];Array.isArray(i)?ye(i,e):e.push(i)}}const We=Object.freeze(Object.defineProperty({__proto__:null,flatten:ze},Symbol.toStringTag,{value:"Module"})),Ge=Te(We);var w=M&&M.__spreadArray||function(t,e,r){if(r||arguments.length===2)for(var i=0,a=e.length,s;i<a;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))};Object.defineProperty(W,"__esModule",{value:!0});W.encode=void 0;var Ke=V,Xe=J,Qe=Ge;function Ye(t,e){return[{absoluteTime:t.ticks,channel:e,deltaTime:0,noteNumber:t.midi,type:"noteOn",velocity:Math.floor(t.velocity*127)},{absoluteTime:t.ticks+t.durationTicks,channel:e,deltaTime:0,noteNumber:t.midi,type:"noteOff",velocity:Math.floor(t.noteOffVelocity*127)}]}function Ze(t){return(0,Qe.flatten)(t.notes.map(function(e){return Ye(e,t.channel)}))}function et(t,e){return{absoluteTime:t.ticks,channel:e,controllerType:t.number,deltaTime:0,type:"controller",value:Math.floor(t.value*127)}}function tt(t){for(var e=[],r=0;r<127;r++)t.controlChanges.hasOwnProperty(r)&&t.controlChanges[r].forEach(function(i){e.push(et(i,t.channel))});return e}function rt(t,e){return{absoluteTime:t.ticks,channel:e,deltaTime:0,type:"pitchBend",value:t.value}}function nt(t){var e=[];return t.pitchBends.forEach(function(r){e.push(rt(r,t.channel))}),e}function it(t){return{absoluteTime:0,channel:t.channel,deltaTime:0,programNumber:t.instrument.number,type:"programChange"}}function at(t){return{absoluteTime:0,deltaTime:0,meta:!0,text:t,type:"trackName"}}function st(t){return{absoluteTime:t.ticks,deltaTime:0,meta:!0,microsecondsPerBeat:Math.floor(6e7/t.bpm),type:"setTempo"}}function ot(t){return{absoluteTime:t.ticks,deltaTime:0,denominator:t.timeSignature[1],meta:!0,metronome:24,numerator:t.timeSignature[0],thirtyseconds:8,type:"timeSignature"}}function ct(t){var e=Xe.keySignatureKeys.indexOf(t.key);return{absoluteTime:t.ticks,deltaTime:0,key:e+7,meta:!0,scale:t.scale==="major"?0:1,type:"keySignature"}}function ut(t){return{absoluteTime:t.ticks,deltaTime:0,meta:!0,text:t.text,type:t.type}}function lt(t){var e={header:{format:1,numTracks:t.tracks.length+1,ticksPerBeat:t.header.ppq},tracks:w([w(w(w(w([{absoluteTime:0,deltaTime:0,meta:!0,text:t.header.name,type:"trackName"}],t.header.keySignatures.map(function(r){return ct(r)}),!0),t.header.meta.map(function(r){return ut(r)}),!0),t.header.tempos.map(function(r){return st(r)}),!0),t.header.timeSignatures.map(function(r){return ot(r)}),!0)],t.tracks.map(function(r){return w(w(w([at(r.name),it(r)],Ze(r),!0),tt(r),!0),nt(r),!0)}),!0)};return e.tracks=e.tracks.map(function(r){r=r.sort(function(a,s){return a.absoluteTime-s.absoluteTime});var i=0;return r.forEach(function(a){a.deltaTime=a.absoluteTime-i,i=a.absoluteTime,delete a.absoluteTime}),r.push({deltaTime:0,meta:!0,type:"endOfTrack"}),r}),new Uint8Array((0,Ke.writeMidi)(e))}W.encode=lt;(function(t){var e=M&&M.__awaiter||function(f,u,h,y){function b(m){return m instanceof h?m:new h(function(I){I(m)})}return new(h||(h=Promise))(function(m,I){function T(k){try{p(y.next(k))}catch(P){I(P)}}function S(k){try{p(y.throw(k))}catch(P){I(P)}}function p(k){k.done?m(k.value):b(k.value).then(T,S)}p((y=y.apply(f,u||[])).next())})},r=M&&M.__generator||function(f,u){var h={label:0,sent:function(){if(m[0]&1)throw m[1];return m[1]},trys:[],ops:[]},y,b,m,I;return I={next:T(0),throw:T(1),return:T(2)},typeof Symbol=="function"&&(I[Symbol.iterator]=function(){return this}),I;function T(p){return function(k){return S([p,k])}}function S(p){if(y)throw new TypeError("Generator is already executing.");for(;h;)try{if(y=1,b&&(m=p[0]&2?b.return:p[0]?b.throw||((m=b.return)&&m.call(b),0):b.next)&&!(m=m.call(b,p[1])).done)return m;switch(b=0,m&&(p=[p[0]&2,m.value]),p[0]){case 0:case 1:m=p;break;case 4:return h.label++,{value:p[1],done:!1};case 5:h.label++,b=p[1],p=[0];continue;case 7:p=h.ops.pop(),h.trys.pop();continue;default:if(m=h.trys,!(m=m.length>0&&m[m.length-1])&&(p[0]===6||p[0]===2)){h=0;continue}if(p[0]===3&&(!m||p[1]>m[0]&&p[1]<m[3])){h.label=p[1];break}if(p[0]===6&&h.label<m[1]){h.label=m[1],m=p;break}if(m&&h.label<m[2]){h.label=m[2],h.ops.push(p);break}m[2]&&h.ops.pop(),h.trys.pop();continue}p=u.call(f,h)}catch(k){p=[6,k],b=0}finally{y=m=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Header=t.Track=t.Midi=void 0;var i=V,a=J,s=E,n=W,l=function(){function f(u){var h=this,y=null;if(u){var b=u instanceof ArrayBuffer?new Uint8Array(u):u;y=(0,i.parseMidi)(b),y.tracks.forEach(function(m){var I=0;m.forEach(function(T){I+=T.deltaTime,T.absoluteTime=I})}),y.tracks=d(y.tracks)}this.header=new a.Header(y),this.tracks=[],u&&(this.tracks=y.tracks.map(function(m){return new s.Track(m,h.header)}),y.header.format===1&&this.tracks[0].duration===0&&this.tracks.shift())}return f.fromUrl=function(u){return e(this,void 0,void 0,function(){var h,y;return r(this,function(b){switch(b.label){case 0:return[4,fetch(u)];case 1:return h=b.sent(),h.ok?[4,h.arrayBuffer()]:[3,3];case 2:return y=b.sent(),[2,new f(y)];case 3:throw new Error("Could not load '".concat(u,"'"))}})})},Object.defineProperty(f.prototype,"name",{get:function(){return this.header.name},set:function(u){this.header.name=u},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"duration",{get:function(){var u=this.tracks.map(function(h){return h.duration});return Math.max.apply(Math,u)},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"durationTicks",{get:function(){var u=this.tracks.map(function(h){return h.durationTicks});return Math.max.apply(Math,u)},enumerable:!1,configurable:!0}),f.prototype.addTrack=function(){var u=new s.Track(void 0,this.header);return this.tracks.push(u),u},f.prototype.toArray=function(){return(0,n.encode)(this)},f.prototype.toJSON=function(){return{header:this.header.toJSON(),tracks:this.tracks.map(function(u){return u.toJSON()})}},f.prototype.fromJSON=function(u){var h=this;this.header=new a.Header,this.header.fromJSON(u.header),this.tracks=u.tracks.map(function(y){var b=new s.Track(void 0,h.header);return b.fromJSON(y),b})},f.prototype.clone=function(){var u=new f;return u.fromJSON(this.toJSON()),u},f}();t.Midi=l;var o=E;Object.defineProperty(t,"Track",{enumerable:!0,get:function(){return o.Track}});var c=J;Object.defineProperty(t,"Header",{enumerable:!0,get:function(){return c.Header}});function d(f){for(var u=[],h=0;h<f.length;h++)for(var y=u.length,b=new Map,m=Array(16).fill(0),I=0,T=f[h];I<T.length;I++){var S=T[I],p=y,k=S.channel;if(k!==void 0){S.type==="programChange"&&(m[k]=S.programNumber);var P=m[k],G="".concat(P," ").concat(k);b.has(G)?p=b.get(G):(p=y+b.size,b.set(G,p))}u[p]||u.push([]),u[p].push(S)}return u}})(de);const U=class{static save(e){this.getSaveNames().includes(e)||localStorage.setItem("midi2mml::advOpt.saveNames",JSON.stringify([...U.getSaveNames(),e])),localStorage.setItem(`midi2mml::advOpt.saves[${e}]`,JSON.stringify(U.current))}static saveCurrent(){localStorage.setItem("midi2mml::advOpt.lastSave",JSON.stringify(U.current))}static getSaveNames(){var e;return JSON.parse((e=localStorage.getItem("midi2mml::advOpt.saveNames"))!=null?e:"[]")}static loadFromSave(e){const r=localStorage.getItem(`midi2mml::advOpt.saves[${e}]`);r&&(U.current=JSON.parse(r))}static loadLastSave(){const e=localStorage.getItem("midi2mml::advOpt.lastSave");e&&(U.current=JSON.parse(e))}};let g=U;ce(g,"current");function te(){var t;return JSON.parse((t=localStorage.getItem("midi2mml::advOpt.enabled"))!=null?t:"false")}function ft(t,e,r){let i=r;for(let a=0;a<e.length;a++)if(t===e[a][0]){i=e[a][1];break}return i}function be(t,e){const r=dt(pt(yt(Z(t.notes),"desc"))),i=[];for(const a of r){if(a.length==0)break;let s=0,n=0,l="";a.forEach(o=>{const c=o.durationTicks,d=o.ticks,f=o.octave-1;for(te()&&e.divideMeasure>0&&(e.divideMeasureOffset+s)%(512*e.divideMeasure)==0&&(l+=" "),ge(s,o)&&(l+=ht(d-s),s+=d-s);f!=n;)f>n?(l+=">",n++):f<n&&(l+="<",n--);l+=`${mt(o.name)}${F(c)}`,s+=o.durationTicks}),i.push(l.trim())}return i}function R(t,e){var i;let r="";if(te()&&e.divideMeasure>0){const a=he(t);let s=[];const n=(i=a.notes)==null?void 0:i[0].ticks;if(n>0){let c=0;for(;c>0;)if((c%512||0)===0){const f={ticks:c,durationTicks:512,midi:0,velocity:0,name:"R"};c+=512,s.push(f)}else{const f={ticks:c,durationTicks:n-c,midi:0,velocity:0,name:"R"};c+=n-c,s.push(f);break}}s=s.concat(t.notes);const l=Object.entries(Z(s)),o=[];for(const[c,d]of l)parseInt(c)>=512*e.divideMeasure*o.length&&o.push([]),o[o.length-1].push([c,d]);for(const c of o){for(const[,d]of c)if(d[0].name=="R")r+=`r${F(d[0].durationTicks)}`;else{let f=0;d.forEach(u=>f+=fe(u)),r+=`@${f}c${F(d[0].durationTicks)}`}r+=" "}}else{const a=he(t),s=Object.entries(Z(a.notes));for(const[,n]of s)if(n[0].name=="R")r+=`r${F(n[0].durationTicks)}`;else{let l=0;n.forEach(o=>l+=fe(o)),r+=`@${l}c${F(n[0].durationTicks)}`}}return r.trim()}function ge(t,e){return e.ticks>t}function ht(t){return`r${F(t)}`}function fe(t){return ft(t.name,[["C2",1],["E2",2],["F2",4],["A2",8],["C3",16],["XX",32],["D2",64],["F#2",128],["A#2",256],["C#3",512],["D#3",1024]],0)}function F(t){let e=t,r="";for(;e>0;)e>=512?(e=e-512,r+="1&"):e>=256?(e=e-256,r+="2&"):e>=128?(e=e-128,r+="4&"):e>=64?(e=e-64,r+="8&"):e>=32?(e=e-32,r+="16&"):e>=16?(e=e-16,r+="32&"):(r=r.slice(0,r.length-1),r+=`%${Math.floor(e/2)}&`,e=0);return r.slice(0,r.length-1)}function dt(t){const e=[];let r=-1,i=0;return t.forEach(a=>{r!=a.ticks?(r=a.ticks,i=0):i+=1,e[i]==null&&e.push([]),e[i].push(a)}),e}function mt(t){return t.toLowerCase().slice(0,t.length-1).replace("#","+")}function he(t){var s,n,l;let e=0,r,i={...t,notes:[]};const a=o=>e==0?ge(e,o):r!=null?o.ticks-r.ticks>r.duration:!1;for(const o of t.notes){const{ticks:c}=o;if(a(o))for(;e<c;)if((e%512||0)===0){const f={ticks:e,durationTicks:512,midi:0,velocity:0,name:"R"};e+=512,(s=i.notes)==null||s.push(f)}else{const f={ticks:e,durationTicks:o.ticks-e,midi:0,velocity:0,name:"R"};e+=o.ticks-e,(n=i.notes)==null||n.push(f);break}(l=i.notes)==null||l.push(o),e=o.ticks+o.durationTicks,r=o}return i}function pt(t){return Object.values(t).flat(4)}function yt(t,e="asc"){const r={};for(const[i,a]of Object.entries(t)){const s=a.sort(e=="desc"?gt:bt);r[i.toString()]=s}return r}function Z(t){const e={};let r=0;return t.forEach(i=>{r=i.ticks,e[r.toString()]==null&&(e[r.toString()]=[]),e[r.toString()].push(i)}),e}function D(t){return t==null||t.length==0||g.current.rhythmPresets.replace(/\s/g,"").split(",").forEach(r=>{const[i,a]=r.split("=");t=t.replaceAll(i,a)}),t}function bt(t,e){return t.midi-e.midi}function gt(t,e){return e.midi-t.midi}const vt=document.querySelector("#inputMidi"),kt=document.querySelector("#btnConvert"),It=document.querySelector("#advOptToggle"),xt=document.querySelector("#tracks"),Tt=document.querySelector("#saveOptBtn"),St=document.querySelector("#loadOptBtn"),wt=document.querySelector("#resetOptBtn"),Q=document.querySelector("#advOptWrapper"),re=document.querySelector("#divideMeasure"),ne=document.querySelector("#divideMeasureOffset"),ie=document.querySelector("#midiOffset"),ae=document.querySelector("#rhythmPresets"),se=document.querySelector("#processAsRhythm"),oe=xt.querySelector("tbody"),ve={divideMeasure:0,divideMeasureOffset:0,midiOffset:0,rhythmPresets:"",processAsRhythm:"9",process9AsRhythm:!0};let B=!1;window.onload=()=>{kt.addEventListener("click",Ot),It.onclick=t=>{t.preventDefault(),B=!B,B?Q.classList.remove("hidden"):Q.classList.add("hidden"),localStorage.setItem("midi2mml::advOpt.enabled",JSON.stringify(B))},Tt.onclick=()=>{const t=Object.entries(localStorage).filter(([r])=>r.includes("midi2mml::saves")),e=prompt("Save as:",t.length.toString());e&&(g.save(e),alert(`Saved as "${e}"`))},St.onclick=()=>{let t="Available Saves:";t+=`
${g.getSaveNames()}`,t+=`

Enter save name to load:`;const e=prompt(t);e&&(g.loadFromSave(e),g.saveCurrent(),Y())},wt.onclick=()=>{g.current=ve,Y()},Nt(),Y(),re.onchange=()=>_(),ne.onchange=()=>_(),ie.onchange=()=>_(),ae.onchange=()=>_(),se.onchange=()=>_(),te()&&(Q.classList.remove("hidden"),B=!0)};function Ot(){const t=vt.files[0];if(t){const e=URL.createObjectURL(t);de.Midi.fromUrl(e).then(r=>{oe.textContent="",g.current.divideMeasure>0?Ut(r):Ct(r)})}else alert("Select the file first.")}function Ut(t){const e=g.current.processAsRhythm.split(",");for(const r of t.tracks){const i=oe.insertRow(),[a,s,n]=[i.insertCell(),i.insertCell(),i.insertCell()];if(a.appendChild(document.createTextNode(r.channel.toString())),s.appendChild(document.createTextNode(r.name)),e.includes(r.channel)){const o=R(r,g.current).split(" ");o.map((c,d)=>{const f=document.createElement("div");if(f.textContent=g.current.rhythmPresets?D(c):c,n.appendChild(f),d<o.length-1){const u=document.createElement("hr");u.classList.add("border-zinc-600","mb-2"),n.appendChild(u)}})}else{const o=g.current.processAsRhythm.split(",").map(c=>c.trim()).includes(r.channel.toString())?[R(r,g.current)]:be(r,g.current);o.forEach((c,d)=>{const f=c.split(" ");if(f.map((u,h)=>{const y=document.createElement("div");if(y.textContent=g.current.rhythmPresets?D(u):u,n.appendChild(y),h<f.length-1){const b=document.createElement("hr");b.classList.add("border-zinc-600","mb-2"),n.appendChild(b)}}),d<o.length-1){const u=document.createElement("hr");u.classList.add("border-zinc-100","mb-2"),n.appendChild(u)}})}}}function Ct(t){const e=g.current.processAsRhythm.split(",");for(const r of t.tracks){const i=oe.insertRow(),[a,s,n]=[i.insertCell(),i.insertCell(),i.insertCell()];if(a.appendChild(document.createTextNode(r.channel.toString())),s.appendChild(document.createTextNode(r.name)),e.includes(r.channel)){const l=R(r,g.current),o=document.createElement("div");o.textContent=g.current.rhythmPresets?D(l):l,n.appendChild(o)}else(g.current.processAsRhythm.split(",").map(c=>c.trim()).includes(r.channel.toString())?[R(r,g.current)]:be(r,g.current)).forEach(c=>{const d=document.createElement("div");d.textContent=g.current.rhythmPresets?D(c):c,n.appendChild(d)})}}function Nt(){g.current={...ve},g.loadLastSave()}function _(){g.current={divideMeasure:parseInt(re.value),divideMeasureOffset:parseInt(ne.value),midiOffset:parseInt(ie.value),rhythmPresets:ae.value,processAsRhythm:se.value,process9AsRhythm:!0},setTimeout(()=>{g.saveCurrent()},1e3)}function Y(){re.value=g.current.divideMeasure.toString(),ne.value=g.current.divideMeasureOffset.toString(),ie.value=g.current.midiOffset.toString(),ae.value=g.current.rhythmPresets,se.value=g.current.processAsRhythm}
